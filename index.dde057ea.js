const e={readItem(e,t){try{const a=JSON.parse(localStorage.getItem(e));return a||t}catch(e){return null}},addItem(e,t){localStorage.setItem(e,JSON.stringify(t))}},t=new class{async fetchPopular(){try{const e=`https://api.themoviedb.org/3/trending/movie/day?api_key=03779c52c93ea63ebe46db37a334d7d8&page=${this.page}`,t=await fetch(e),a=await t.json();return console.log(a),a.results}catch(e){console.log(e)}}async fetchByQuery(e){try{const t=`https://api.themoviedb.org/3/search/movie?api_key=03779c52c93ea63ebe46db37a334d7d8&language=en-US&query=${e}&page=${this.page}&include_adult=false`,a=await fetch(t);return(await a.json()).results}catch(e){console.log(e)}}async getGenres(){try{const e="https://api.themoviedb.org/3/genre/movie/list?api_key=03779c52c93ea63ebe46db37a334d7d8&language=en-US",t=await fetch(e),a=await t.json();return console.log(a),a}catch(e){console.log(e)}}async getCountByQuery(e){try{const t=`https://api.themoviedb.org/3/search/movie?api_key=03779c52c93ea63ebe46db37a334d7d8&language=en-US&query=${e}&include_adult=false`,a=await fetch(t);return(await a.json()).total_results}catch(e){console.log(e)}}async fetchById(e){try{const t=`https://api.themoviedb.org/3/movie/${e}?api_key=03779c52c93ea63ebe46db37a334d7d8&language=en-US`,a=await fetch(t);return await a.json()}catch(e){console.log(e)}}setCurrentPage(e){this.page=e}incrementPage(){this.page+=1}resetPage(){this.page=1}constructor(){this.searchQuery="",this.page=1}},a=document.querySelector(".container-card"),n=document.querySelector(".modal__card-content");async function i(e){const n=await t.fetchByQuery(e);a.innerHTML=await s(n)}function s(e){return e.map((({poster_path:e,id:t,original_title:a,release_date:n,genre_ids:i})=>{const s=n.split("-")[0],o=[{id:28,name:"Action"},{id:12,name:"Adventure"},{id:16,name:"Animation"},{id:35,name:"Comedy"},{id:80,name:"Crime"},{id:99,name:"Documentary"},{id:18,name:"Drama"},{id:10751,name:"Family"},{id:14,name:"Fantasy"},{id:36,name:"History"},{id:27,name:"Horror"},{id:10402,name:"Music"},{id:9648,name:"Mystery"},{id:10749,name:"Romance"},{id:878,name:"Science Fiction"},{id:10770,name:"TV Movie"},{id:53,name:"Thriller"},{id:10752,name:"War"},{id:37,name:"Western"}],d=i.reduce(((e,t)=>{const a=o.filter((e=>e.id===t))[0];return e.push(a.name),e.slice(0,3)}),[]);return console.log(d.length),3===d.length&&d.splice(2,1,"Other"),`\n                  <div class="container-card_single-card" data-id="${t}" >\n                    <div class="poster">\n                        <img src="https://image.tmdb.org/t/p/w500${e}" alt="${a}">\n                    </div>\n                    <div class="info">\n                      <h3 class="info_title">${a}</h3>\n                      <p class="info_details">\n                          ${d.join(", ")} | ${s}\n                      </p>\n                    </div>\n                  </div> \n        `})).join("")}async function o(a){const i=await t.fetchById(a);n.innerHTML=await function({poster_path:e,original_title:t,overview:a,popularity:n,genres_name:i,vote_average:s,vote_count:o}){return`\n    <button type="button" class="modal__close" data-modal-close>\n      <svg class="modal__close-svg">\n        X\n      </svg>\n    </button>\n  <img src="https://image.tmdb.org/t/p/w500${e}" alt="${t}" class="modal__img" />\n  <div class="modal__info">\n    <h2 class="modal__info-title">${t}</h2>\n    <div class="modal__info-block">\n      <ul class="modal__info discription__modal">\n        <li class="discription__modal-item">\n          <p class="discription__modal-title">Vote / Votes</p>\n        </li>\n        <li class="discription__modal-item">\n          <p class="discription__modal-title">Popularity</p>\n        </li>\n        <li class="discription__modal-item">\n          <p class="discription__modal-title">Original Title</p>\n        </li>\n        <li class="discription__modal-item">\n          <p class="discription__modal-title">Genre</p>\n        </li>\n      </ul>\n      \n      <ul class="modal__info">\n        <li class="discription__modal-item">\n          <p class="discription__modal-text">\n          <span class="discription__modal-text-vote">${s}</span>\n          <span class="discription__modal-text-slash">/</span>\n          <span class="discription__modal-text-votes">${o}</span>\n          </p>\n        </li>\n        <li class="discription__modal-item">\n          <p class="discription__modal-text">${n.toFixed(1)}</p>\n        </li>\n        <li class="discription__modal-item">\n          <p class="discription__modal-text">${t}</p>\n        </li>\n        <li class="discription__modal-item">\n          <p class="discription__modal-text">${i} </p>\n        </li>\n      </ul>\n    </div>\n    <div class="modal__info about__modal">\n      <h4 class="about__modal-title">About</h4>\n      <p class="about__modal-text">${a}</p>\n    </div>\n    <div class="modal__button">\n      <button type="button" class="modal__btn-add modal__btn-1add">add to Watched</button>\n      <button type="button" class="modal__btn-add modal__btn-1remove hide-btn">remove from Watched</button>\n      <button type="button" class="modal__btn-add modal__btn-2add">add to queue</button>\n      <button type="button" class="modal__btn-add modal__btn-2remove hide-btn">remove from queue</button>\n    </div>\n  </div>`}(i);const s=document.querySelector(".modal__close"),o=document.querySelector(".modal__card-overlay");s.addEventListener("click",(()=>{o.classList.add("is-hidden")}));const d=document.querySelector(".modal__btn-1add"),c=document.querySelector(".modal__btn-2add"),l=document.querySelector(".modal__btn-1remove"),r=document.querySelector(".modal__btn-2remove");d.addEventListener("click",(async()=>{const n=await t.fetchById(a),i=e.readItem("watched",[]),s=e.readItem("qu");if(s){const t=n.title,a=s.findIndex((e=>e.title===t));if(a>=0){s.splice(a,1);e.addItem("qu",s),i.push(n),e.addItem("watched",i)}else-1===a&&(i.push(n),e.addItem("watched",i))}else i.push(n),e.addItem("watched",i);d.classList.add("hide-btn"),l.classList.remove("hide-btn")})),c.addEventListener("click",(async()=>{const n=await t.fetchById(a),i=e.readItem("qu",[]),s=e.readItem("watched");if(s){const t=n.title,a=s.findIndex((e=>e.title===t));if(a>=0){s.splice(a,1);e.addItem("watched",s),i.push(n),e.addItem("qu",i)}else-1===a&&(i.push(n),e.addItem("qu",i))}else i.push(n),e.addItem("qu",i);c.classList.add("hide-btn"),r.classList.remove("hide-btn")})),l.addEventListener("click",(()=>{const t=e.readItem("watched"),a=i.title,n=t.findIndex((e=>e.title===a));if(-1===n)console.log("error");else{t.splice(n,1);e.addItem("watched",t)}l.classList.add("hide-btn"),d.classList.remove("hide-btn")})),r.addEventListener("click",(()=>{const t=e.readItem("qu"),a=i.title,n=t.findIndex((e=>e.title===a));if(-1===n)console.log("error");else{t.splice(n,1);e.addItem("qu",t)}r.classList.add("hide-btn"),c.classList.remove("hide-btn")}))}const d=document.querySelector(".header-input-container"),c=document.querySelector("#search-box");d.addEventListener("submit",(function(e){try{e.preventDefault(),searchQuery=c.value,""===searchQuery&&console.log("надо ввести фильм"),i(searchQuery)}catch{}})),async function(){const e=await t.fetchPopular();console.log(e),a.insertAdjacentHTML("beforeend",s(e))}();const l=document.querySelector(".modal__card-overlay");document.querySelector(".container-card").addEventListener("click",(e=>{const t=e.path[2];if(!t.classList.contains("container-card_single-card"))return;l.classList.remove("is-hidden");o(t.dataset.id)}));
//# sourceMappingURL=index.dde057ea.js.map
